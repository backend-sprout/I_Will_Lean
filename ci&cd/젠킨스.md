# 젠킨스와 CI/CD
> [T 아카데미 Jenkins CI/CD](https://tacademy.skplanet.com/live/player/onlineLectureDetail.action?seq=190)     
       
**강의 목표**        
* CI/CD 파이프라인의 기본 개념에 대해서 이해한다.       
* 기본적인 운영환경(DEV, QA, PROD)이 어떻게 구성되고 운영되는지 이해한다.      
* Jenkins의 기본 개념에 대해 이해한다.       
* 실제 운영기에서 특히 AWS 기반의 클라우드 환경에서 Jenkins가 어떻게 활용되는지 알 수 있다.     

# 목차 

1. CI/CD란 무엇인가? 
2. Jenkins의 기본 개념과 동작 방식
3. 개발 환경 및 CI/CD의 기본동작 이해
4. Jenkins 및 플로그인 설치 실습
5. CI/CD 파이프라인 구축 및 QnA   
6. 실제 운영 환경에서 Jenkins 사용 사례 알아보기(DW ETL Pipeline)     

# CI/CD란 무엇인가?   

**Continuous Integration = 지속적인 통합**   
여러 개발자들의 코드베이스를 계속해서 통합하는 것        
  
개발자들은 본인의 로컬 PC에서 작업을 진행한다.             
작업이 끝났다면 이후에는 서로의 코드를 통합하는 작업을 진행해야하는데      
이 과정에서 Conflict 이 발생하거나, 네이밍이 겹친다거나 등등 여러 문제가 발생할 수 있다.     
결국 이러한 문제를 해결하려면 개발자들간의 의사소통이 필요하고 그 과정에서 많은 시간을 소모하게 된다.    
  
`Continuous Integration`은 이런 문제를 완벽히 해결해주지 않는다.        
다만, 코드를 통합하는 과정에서 발생하는 문제를 미리 알려주어서              
깃허브나 깃랩에 코드를 올리기 전에 코드를 수정할 수 있도록 기회를 준다.       
즉, 런타임 에러를 잡는게 아니라 컴파일 타임에서 에러를 잡는것과 비슷한 맥락이다.   
     
결과적으로 아무런 문제가 없는 코드들이 원격 저장소에 올라가고       
특정 명령어를 추가함으로써 Develop 브랜치와 Product 브랜치의 통합을 자동으로 이뤄낼 수 있다.          
    
**Continuous Delivery = 지속적인 배달**        
사용자에게 제품을 서비스를 지속적으로 배달한다.         
코드베이스가 항상 배포가능한 상태를 유지하는 것         
   
**Continue Deployment = 지속적인 배포**       
코드 베이스를 사용자가 사용 가능한 환경에 배포하는 것을 자동화함          
시스템이 내려가지 않으면서 롤링 업데이트(버전 올라가는 것)를 지원해준다.              
      
결론으로 따지자면         
CI/CD란 각각의 개발자들이 개발을 하는 개발 환경을       
사용자가 사용 가능한 서비스로 전달하는 모든 과정을 지속 가능한 형태로        
또 가능하다면 자동으로 해서 개발자와 사용자 사이의 격차를 없애는 것이다.       
이러한 과정에는 코드를 빌드하고, 테스트하고 배포하는 활동이 있다.      
          
* 코드작성 -> 빌드 -> 테스트 -> 배포     

# 젠킨스의 기본 개념과 동작 방식    

젠킨스란,    
Java Runtime 위에서 동작하는 자동화 서버    
빌드, 테스트, 배포 등 모든 것을 자동화 해주는 자동화 서버다.     

* JRE 환경에서 동작
* 다양한 플러그인들을 활용해서 각종 자동화 작업을 처리할 수 있다.    
* 일련의 자동화 작업의 순서들의 집합인 Pipeline을 통해 CI/CD 파이프라인을 구축함 

**대표적인 플러그인**     
* Credentials Plugin  
* Gid Plugin
* Pipeline 
* Recommend 다운 받으면 왠만하면 다 있다.    

**Credentials Plugin**   
Jenkins는 단순하 서버일 뿐이기에    
배포에 필요한 각종 리소스에 접근하기 위해서는 여러 가지 정보들을 저장하고 있어야 한다.         
즉, 라우드 리소스 혹은 베어메탈에 SSH 접근을 위한 정보를 가지고 있어야 하는데                
이런 중요한 정보(GitHub Token, AWS Key)들을 저장해주는 플러그인이다.                
             
다르게 말하면 젠킨스에게 권한을 주는 것이다(시크릿 키/토큰)          
근데 또 원격 서버에 인증관련 정보들을 저장하니까 안전한지 고민이 될 수 있는데        
Jenkins Instance Id RSA 기반의 공개키 방식의 암호화를 알아서 진행하기에 보안에 안전하다.       

**Docker plugin and Docker Pipeline**     
Docker agent를 사용하고 jenkins 서버에서 도커를 사용하기 위함        

# Pipeline    
파이프라인이란, CI/CD 파이프라인을 젠킨스에 구성하기 위한 일련의 플러그인들의 집합이자 구성이다.    
즉, 여러 플로그인들을 이 파이프라인에서 용도에 맞게 사용하고 정의함으로써 파이프라인을 통해 서비스가 배포된다..    
    
두가지 형태의 Pipeline syntax가 존재하는데,(Delarative, Scripted)       
최신이자 더 가독성 좋은 문법을 가진 Declarative Pipeline syntax를 사용한다.    

## Pipeline Syntax   

* Agent Section 
* Post Section 
* Stages Section
* Steps Section  

section은 특정 작업에 단위라고 보면 된다.    

**Agent Section**     
젠킨스는 많은 일들을 해야하기 때문에 혼자 작업하기가 버겁다.    
여러 **slave node**를 두고 일을 시킬 수 있는데, 이처럼 **어떤 젠킨스(node)가 일을 하게 할 것인지를 지정한다.**    
젠킨스 노드 관리에서 새로 노드를 띄우거나 혹은 docker 이미지등을 통해서 처리할 수 있다.       


**Post Section**    
```
post {
    success {
        echo 'success'
    }
}
```
* success, failure, always, cleanup    
  
스테이지가 끝난 이후의 경과에 따라서 후속 조치를 시킨다.     




**Stage Section**

**Steps Section**     

****


















